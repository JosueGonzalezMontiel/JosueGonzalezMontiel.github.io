<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Gestión de Usuarios, Clientes y Autos</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link rel="stylesheet" href="./main.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <script src="./main.js" type="module"></script>
    <style>
        .button-group {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }
    </style>
</head>
<body>
    <!--Barra de navegacion de Boostrap-->
    <nav class="navbar navbar-expand-lg bg-dark navbar-dark">
        <div class="container-fluid">
          <a class="navbar-brand" href="#">JPDL AUTOS</a>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
          </button>
          <div class="collapse navbar-collapse" id="navbarNav">
            <ul class="navbar-nav ms-auto">
              <li class="nav-item">
                <a class="nav-link logged-out" href="#" data-bs-toggle="modal" data-bs-target="#singin-modal">Singin</a>
              </li>
              <li class="nav-item">
                <a class="nav-link logged-out" href="#" data-bs-toggle="modal" data-bs-target="#singup-modal">Singup</a>
              </li>
              <li class="nav-item">
                <a class="nav-link logged-in" id="logout" href="#" >Logout</a>
              </li>
            </ul>
          </div>
        </div>
      </nav>
    <!--Termina Barra de navegacion-->
    <!--Inicia modal inicio de sesion-->
    <div class="modal fade" id="singin-modal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content bg-dark">
          <div class="modal-header">
            <h1 class="modal-title fs-5" id="exampleModalLabel">Login</h1>
            <button type="button" class="btn-close bg-light" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <form id="login-form">
              <label for="email">E-mail:</label>
              <input type="email" id="login-email" class="form-control mb-3" placeholder="Email" required>
              <label for="password">Password:</label>
              <input type="password" id="login-password" class="form-control mb-3" placeholder="******" required>
              <button type="submit" class="btn btn-outline-info form-control">Login</button>
            </form>
            
          </div>
          <div class="modal-footer">
            <button type="button" id="google-login" class="btn btn-light "> 
              <svg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" width="30" height="30" viewBox="0 0 48 48">
              <path fill="#FFC107" d="M43.611,20.083H42V20H24v8h11.303c-1.649,4.657-6.08,8-11.303,8c-6.627,0-12-5.373-12-12c0-6.627,5.373-12,12-12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657C34.046,6.053,29.268,4,24,4C12.955,4,4,12.955,4,24c0,11.045,8.955,20,20,20c11.045,0,20-8.955,20-20C44,22.659,43.862,21.35,43.611,20.083z"></path><path fill="#FF3D00" d="M6.306,14.691l6.571,4.819C14.655,15.108,18.961,12,24,12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657C34.046,6.053,29.268,4,24,4C16.318,4,9.656,8.337,6.306,14.691z"></path><path fill="#4CAF50" d="M24,44c5.166,0,9.86-1.977,13.409-5.192l-6.19-5.238C29.211,35.091,26.715,36,24,36c-5.202,0-9.619-3.317-11.283-7.946l-6.522,5.025C9.505,39.556,16.227,44,24,44z"></path><path fill="#1976D2" d="M43.611,20.083H42V20H24v8h11.303c-0.792,2.237-2.231,4.166-4.087,5.571c0.001-0.001,0.002-0.001,0.003-0.002l6.19,5.238C36.971,39.205,44,34,44,24C44,22.659,43.862,21.35,43.611,20.083z"></path>
              </svg>With Google</button>
            <button type="button" id="facebook-login" class="btn btn-light "><svg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" width="30" height="30" viewBox="0 0 64 64">
              <radialGradient id="nT5WH7nXAOiS46rXmee3Oa_msQ6HdxpqUmi_gr1" cx="33.34" cy="27.936" r="43.888" gradientTransform="matrix(1 0 0 -1 0 66)" gradientUnits="userSpaceOnUse"><stop offset="0" stop-color="#f4e9c3"></stop><stop offset=".219" stop-color="#f8eecd"></stop><stop offset=".644" stop-color="#fdf4dc"></stop><stop offset="1" stop-color="#fff6e1"></stop></radialGradient><path fill="url(#nT5WH7nXAOiS46rXmee3Oa_msQ6HdxpqUmi_gr1)" d="M51.03,37.34c0.16,0.98,1.08,1.66,2.08,1.66h5.39c2.63,0,4.75,2.28,4.48,4.96	C62.74,46.3,60.64,48,58.29,48H49c-1.22,0-2.18,1.08-1.97,2.34c0.16,0.98,1.08,1.66,2.08,1.66h8.39c1.24,0,2.37,0.5,3.18,1.32	C61.5,54.13,62,55.26,62,56.5c0,2.49-2.01,4.5-4.5,4.5h-49c-1.52,0-2.9-0.62-3.89-1.61C3.62,58.4,3,57.02,3,55.5	C3,52.46,5.46,50,8.5,50H14c1.22,0,2.18-1.08,1.97-2.34C15.81,46.68,14.89,44,13.89,44H5.5c-2.63,0-4.75-2.28-4.48-4.96	C1.26,36.7,3.36,35,5.71,35H8c1.71,0,3.09-1.43,3-3.16C10.91,30.22,9.45,29,7.83,29H4.5c-2.63,0-4.75-2.28-4.48-4.96	C0.26,21.7,2.37,20,4.71,20H20c0.83,0,1.58-0.34,2.12-0.88C22.66,18.58,23,17.83,23,17c0-1.66-1.34-3-3-3h-1.18	c-0.62-0.09-1.43,0-2.32,0h-9c-1.52,0-2.9-0.62-3.89-1.61S2,10.02,2,8.5C2,5.46,4.46,3,7.5,3h49c3.21,0,5.8,2.79,5.47,6.06	C61.68,11.92,60.11,14,57.24,14H52c-2.76,0-5,2.24-5,5c0,1.38,0.56,2.63,1.46,3.54C49.37,23.44,50.62,24,52,24h6.5	c3.21,0,5.8,2.79,5.47,6.06C63.68,32.92,61.11,35,58.24,35H53C51.78,35,50.82,36.08,51.03,37.34z"></path><linearGradient id="nT5WH7nXAOiS46rXmee3Ob_msQ6HdxpqUmi_gr2" x1="32" x2="32" y1="-3.34" y2="59.223" gradientTransform="matrix(1 0 0 -1 0 66)" gradientUnits="userSpaceOnUse"><stop offset="0" stop-color="#155cde"></stop><stop offset=".278" stop-color="#1f7fe5"></stop><stop offset=".569" stop-color="#279ceb"></stop><stop offset=".82" stop-color="#2cafef"></stop><stop offset="1" stop-color="#2eb5f0"></stop></linearGradient><path fill="url(#nT5WH7nXAOiS46rXmee3Ob_msQ6HdxpqUmi_gr2)" d="M58,32c0,13.35-10.05,24.34-23,25.83C34.02,57.94,33.01,58,32,58c-1.71,0-3.38-0.17-5-0.49	C15.03,55.19,6,44.65,6,32C6,17.64,17.64,6,32,6S58,17.64,58,32z"></path><path fill="#fff" d="M42.8,36.05l-0.76,2C41.6,39.22,40.46,40,39.19,40H35v17.83C34.02,57.94,33.01,58,32,58	c-1.71,0-3.38-0.17-5-0.49V40h-2.95C22.36,40,21,38.66,21,37v-2c0-1.66,1.36-3,3.05-3H27v-6c0-5.51,4.49-10,10-10h3	c2.21,0,4,1.79,4,4s-1.79,4-4,4h-3c-1.1,0-2,0.9-2,2v6h4.95C42.08,32,43.55,34.09,42.8,36.05z"></path>
              </svg>With Facebook</button>
          </div>
        </div>
      </div>
    </div>
    <!--Termina modal inicio de sesion-->
    <!--Inicia modal registro-->
    <div class="modal fade" id="singup-modal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content bg-dark">
          <div class="modal-header">
            <h1 class="modal-title fs-5" id="exampleModalLabel">Registro</h1>
            <button type="button" class="btn-close bg-light" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <form id="singup-from">
              <label for="email">E-mail:</label>
              <input type="email" id="singup-email" class="form-control mb-3" placeholder="Email" required>
              <label for="password">Password:</label>
              <input type="password" id="singup-password" class="form-control mb-3" placeholder="******" required>
              <button type="submit" class="btn btn-info form-control">Registro</button>
            </form>
          </div>
          <div class="modal-footer">
          </div>
        </div>
      </div>
    </div>
    <!--Termina modal registro-->
    <h1>Gestión de Autos</h1>


    <!-- Autos -->
    <h2>Autos</h2>
    <div class="button-group">
        <button onclick="obtenerAutos()">Mostrar Todos los Autos</button>
        <select id="listaAutos" onchange="llenarFormularioAuto()"></select>
        <button onclick="enviarDatosAuto()">Enviar Datos</button>
        <button onclick="actualizarDatosAuto()">Actualizar Datos</button>
        <button onclick="eliminarAuto()">Eliminar Auto</button>
    </div>
    <form id="formularioAuto"></form>


    <div id="resultado"></div>

    <!--Inicio del Footer-->
    <footer class="bg-dark text-white text-center py-4 mt-5">
        <div>
            <div class="row">
                <div class="col-md-4 mb-3">
                    <h5>Sobre Nosotros</h5>
                    <p class="small">Somos una empresa decidada a ofrecerte herramientas que te ayuden en los procesos de tu negocio, operamos bajo saas y podemos ayudarte a automatizar tu negocio</p>
                </div>
                <div class="col-md-4 mb-3">
                    <h5>Enlaces Rápidos</h5>
                    <ul class="list-unstyled">
                        <li><a href="./index.html" class="btn btn-secondary mb-3" role="button">Inicio</a></li>
                    </ul>
                </div>
                <div class="col-md-4 mb-3">
                    <h5>Síguenos</h5>
                    <a href="#" class="text-white me-2"><i class="fab fa-facebook-f"></i></a>
                    <a href="#" class="text-white me-2"><i class="fab fa-twitter"></i></a>
                    <a href="#" class="text-white me-2"><i class="fab fa-instagram"></i></a>
                    <a href="#" class="text-white"><i class="fab fa-linkedin-in"></i></a>
                </div>
            </div>
            <div class="row">
                <div class="col-12">
                    <p class="small mb-0">&desarrollado por JSAAS. Todos los derechos reservados.</p>
                </div>
            </div>
        </div>
      </footer>
  <!--Fin del Footer-->



    <script>
        

        // Funciones para Clientes
        function obtenerClientes() {
            fetch('http://127.0.0.1:8018/clientes/')
                .then(response => response.json())
                .then(data => {
                    const listaClientes = document.getElementById('listaClientes');
                    listaClientes.innerHTML = '<option selected disabled>Seleccione un cliente</option>';
                    data.forEach(cliente => {
                        const option = document.createElement('option');
                        option.value = cliente.numero;
                        option.text = cliente.nombre;
                        option.dataset.cliente = JSON.stringify(cliente);
                        listaClientes.appendChild(option);
                    });
                })
                .catch(error => {
                    document.getElementById('listaClientes').innerHTML = '<option>Error al cargar clientes</option>';
                });
        }

        function llenarFormularioCliente() {
            const seleccionado = document.getElementById('listaClientes').selectedOptions[0];
            const cliente = JSON.parse(seleccionado.dataset.cliente);
            const formulario = document.getElementById('formularioCliente');
            formulario.innerHTML = '';
            Object.keys(cliente).forEach(key => {
                const label = document.createElement('label');
                label.textContent = key + ': ';
                const input = document.createElement('input');
                input.type = 'text';
                input.name = key;
                input.value = cliente[key];
                formulario.appendChild(label);
                formulario.appendChild(input);
                formulario.appendChild(document.createElement('br'));
            });
        }

        function enviarDatosCliente() {
             // Esto detiene el envío predeterminado del formulario
            const formulario = document.getElementById('formularioCliente');
            const datos = {};
            new FormData(formulario).forEach((value, key) => { datos[key] = value; });
            fetch('http://127.0.0.1:8018/agregar_cliente', {method: 'POST',
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(Object.fromEntries(new FormData(formulario)))
            })
            .then(response => {
                if (!response.ok) throw new Error('Fallo al enviar datos');
                return response.json();
            })
            .then(result => {
                document.getElementById('resultado').innerHTML = 'Datos enviados correctamente';
            })
            .catch(error => {
                document.getElementById('resultado').innerHTML = 'Error: ' + error.message;
            });
        }


        function actualizarDatosCliente() {
            const formulario = document.getElementById('formularioCliente');
            const datos = {};
            new FormData(formulario).forEach((value, key) => { datos[key] = value; });
            const nombre = datos['nombre']; // Asume que 'numero' es un identificador único
            fetch(`http://127.0.0.1:8018/clientes/${nombre}`, {method: 'PUT',
                method: 'PUT',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(Object.fromEntries(new FormData(formulario)))
            })
                .then(response => {
                    if (!response.ok) throw new Error('Fallo al actualizar datos');
                    return response.json();
                })
                .then(result => {
                    document.getElementById('resultado').innerHTML = 'Datos actualizados correctamente';
                })
                .catch(error => {
                    document.getElementById('resultado').innerHTML = 'Error: ' + error.message;
                });
        }

        function eliminarCliente() {
            const formulario = document.getElementById('formularioCliente');
            const datos = {};
            new FormData(formulario).forEach((value, key) => { datos[key] = value; });
            const numero = datos['numero']; // Asume que 'numero' es un identificador único
            fetch(`http://127.0.0.1:8018/clientes/${numero}`, {method: 'DELETE',
                method: 'DELETE',
                headers: { 'Content-Type': 'application/json' }
            })
                .then(response => {
                    if (!response.ok) throw new Error('Fallo al eliminar datos');
                    return response.json();
                })
                .then(result => {
                    document.getElementById('resultado').innerHTML = 'Cliente eliminado correctamente';
                    obtenerClientes(); // Actualizar lista de clientes
                })
                .catch(error => {
                    document.getElementById('resultado').innerHTML = 'Error: ' + error.message;
                });
        }

        // Funciones para Autos (deben ser implementadas de manera similar a las de clientes)
        function obtenerAutos() {
            fetch('https://final-api-p6mw.onrender.com/auto1/')
                .then(response => response.json())
                .then(data => {
                    const listaAutos = document.getElementById('listaAutos');
                    listaAutos.innerHTML = '<option selected disabled>Seleccione un auto</option>';
                    data.forEach(auto => {
                        const option = document.createElement('option');
                        option.value = auto.referencia; // Asume que 'referencia' es un identificador único
                        option.text = `${auto.auto} - ${auto.modelo}`; // Muestra marca y modelo
                        option.dataset.auto = JSON.stringify(auto);
                        listaAutos.appendChild(option);
                    });
                })  
                .catch(error => {
                    document.getElementById('listaAutos').innerHTML = '<option>Error al cargar autos</option>';
                });
        }

        function llenarFormularioAuto() {
            const seleccionado = document.getElementById('listaAutos').selectedOptions[0];
            const auto = JSON.parse(seleccionado.dataset.auto);
            const formulario = document.getElementById('formularioAuto');
            formulario.innerHTML = '';
            Object.keys(auto).forEach(key => {
                const label = document.createElement('label');
                label.textContent = key + ': ';
                const input = document.createElement('input');
                input.type = 'text';
                input.name = key;
                input.value = auto[key];
                formulario.appendChild(label);
                formulario.appendChild(input);
                formulario.appendChild(document.createElement('br'));
            });
        }

        function enviarDatosAuto() {
            const formulario = document.getElementById('formularioAuto');
            const datos = {};
            new FormData(formulario).forEach((value, key) => { datos[key] = value; });
            fetch('https://final-api-p6mw.onrender.com/auto', {method: 'POST',
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(Object.fromEntries(new FormData(formulario)))
            })
                .then(response => {
                    if (!response.ok) throw new Error('Fallo al enviar datos');
                    return response.json();
                })
                .then(result => {
                    document.getElementById('resultado').innerHTML = 'Datos de auto enviados correctamente';
                })
                .catch(error => {
                    document.getElementById('resultado').innerHTML = 'Error: ' + error.message;
                });
        }

        function actualizarDatosAuto() {
            const formulario = document.getElementById('formularioAuto');
            const datos = {};
            new FormData(formulario).forEach((value, key) => { datos[key] = value; });
            const referencia = datos['referencia']; // Asume que 'referencia' es un identificador único
            fetch(`https://final-api-p6mw.onrender.com/auto/${referencia}`, {method: 'PUT',
                method: 'PUT',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(Object.fromEntries(new FormData(formulario)))
            })
                .then(response => {
                    if (!response.ok) throw new Error('Fallo al actualizar datos');
                    return response.json();
                })
                .then(result => {
                    document.getElementById('resultado').innerHTML = 'Datos de auto actualizados correctamente';
                })
                .catch(error => {
                    document.getElementById('resultado').innerHTML = 'Error: ' + error.message;
                });
        }

        function eliminarAuto() {
            const seleccionado = document.getElementById('listaAutos').selectedOptions[0];
            const referencia = JSON.parse(seleccionado.dataset.auto).referencia; // Asume que 'referencia' es un identificador único
            fetch(`https://final-api-p6mw.onrender.com/auto/${referencia}`, {method: 'DELETE',
                method: 'DELETE',
                headers: { 'Content-Type': 'application/json' }
            })
                .then(response => {
                    if (!response.ok) throw new Error('Fallo al eliminar datos');
                    return response.json();
                })
                .then(result => {
                    document.getElementById('resultado').innerHTML = 'Auto eliminado correctamente';
                    obtenerAutos(); // Actualizar lista de autos
                })
                .catch(error => {
                    document.getElementById('resultado').innerHTML = 'Error: ' + error.message;
                });
        }

       
</script>
</html>

